#!/bin/bash

# Store the current directory
CURRENT_DIR=$(pwd)

# Find a movie file that includes 'Lower_Third'
MOVIE_FILE=$(find "$CURRENT_DIR" -maxdepth 1 -type f -name "*Lower_Third*.mov" | head -n 1)

# Check if a movie file was found
if [[ -z "$MOVIE_FILE" ]]; then
    echo "No movie file found with 'Lower_Third' in its name."
    exit 1
fi

# Get the duration of the video file using ffprobe
DURATION=$(ffprobe -v error -show_entries format=duration -of default=noprint_wrappers=1:nokey=1 "$MOV to use the path variableIE_FILE")

# Execute the ffmpeg command with the found movie file and duration
ffmpeg -i "$MOVIE_FILE" -loop 1 -t $DURATION -i checkerboard.jpg \
-filter_complex "[1:v]scale=1920x1080,format=yuv420p[bg]; [0:v]format=yuva420p,setpts=PTS-STARTPTS[fg]; [bg][fg]overlay=format=auto:eof_action=pass" \
-c:v libx264 -pix_fmt yuv420p -s 1920x1080 -movflags +faststart output.mp4

echo "Output generated: output.mp4"
